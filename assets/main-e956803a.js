import"https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.4.5/swiper-bundle.min.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();(function(){function e(){if(!document.getElementById("loading")){const t=document.createElement("div");t.id="loading",t.innerHTML='<img src="path-to-your-loading-image.gif" alt="Loading...">',t.style.cssText=`
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: #ffffff;
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 99999;
            `,t.querySelector("img").style.cssText=`
                max-width: 100px;
                height: auto;
            `,document.body?document.body.insertBefore(t,document.body.firstChild):document.addEventListener("DOMContentLoaded",()=>{document.body.insertBefore(t,document.body.firstChild)})}}e()})();function A(){const e=document.getElementById("loading");e&&(e.style.display="flex",document.body.style.overflow="hidden")}function E(){const e=document.getElementById("loading");e&&(e.style.display="none",document.body.style.overflow="")}function X(){return new Promise(e=>{const t=document.querySelectorAll("img"),n=t.length;let c=0;if(n===0){e();return}t.forEach(s=>{s.complete?(c++,c===n&&e()):(s.addEventListener("load",()=>{c++,c===n&&e()}),s.addEventListener("error",()=>{c++,c===n&&e()}))})})}function S(e){return new Promise(t=>{if(document.querySelector(e)){t(document.querySelector(e));return}const n=new MutationObserver(c=>{document.querySelector(e)&&(n.disconnect(),t(document.querySelector(e)))});n.observe(document.documentElement,{childList:!0,subtree:!0})})}document.addEventListener("DOMContentLoaded",function(){A(),Promise.all([S(".navbar"),S("#airContact"),X(),new Promise(e=>setTimeout(e,1e3))]).then(()=>{initializeMenu(),initializeSmoothScroll(),E(),handleAnchorScroll()}).catch(e=>{console.error("Error during initialization:",e),E()})});window.addEventListener("load",function(){const e=document.getElementById("loading");e&&e.style.display!=="none"&&Promise.all([X(),new Promise(t=>setTimeout(t,1e3))]).then(E)});if(document.querySelector(".swiper")){let e=function(){document.querySelectorAll(".swiper-slide").forEach(n=>{n.classList.contains("swiper-slide-active")?n.setAttribute("draggable","true"):(n.setAttribute("draggable","false"),n.addEventListener("dragstart",c=>c.preventDefault()))})};new Swiper(".swiper",{slidesPerView:1,centeredSlides:!0,spaceBetween:20,initialSlide:1,effect:"coverflow",coverflowEffect:{rotate:0,stretch:0,depth:100,modifier:1,slideShadows:!1},breakpoints:{768:{slidesPerView:2,spaceBetween:30},992:{slidesPerView:2.5,spaceBetween:80}},on:{slideChange:function(){e()}}}),e()}function D(){const e=document.querySelectorAll(".menuToggle"),t=document.querySelector(".navbar-toggler"),n=document.getElementById("airContact"),c=document.querySelectorAll(".close-button"),s=document.querySelector(".navbar");if(!n){console.warn("Air contact element not found");return}function r(o){var L;o.preventDefault();const p=o.target.closest(".menu-item");if(!p)return;const m=(L=p.querySelector("h1"))==null?void 0:L.textContent.trim();if(!m)return;let d;switch(m){case"關於我們":d="about";break;case"服務項目":d="server";break;case"專案實績":d="work";break;case"回到主頁":a();return}if(d)if(o.preventDefault(),a(),window.location.pathname==="/netmet/"){const b=document.getElementById(d);b&&b.scrollIntoView({behavior:"smooth",block:"start"})}else window.location.href=`/netmet/#${d}`,window.location.href=`/netmet/#${d}`}c.forEach(o=>{o.addEventListener("click",a)}),e.forEach(o=>{o.addEventListener("click",i)});function i(o){o.preventDefault(),o.stopPropagation(),n.classList.add("active")}function a(o){o&&(o.preventDefault(),o.stopPropagation()),n.classList.remove("active"),document.body.style.overflow="auto"}t&&(t.removeAttribute("data-bs-toggle"),t.removeAttribute("data-bs-target"),t.addEventListener("click",i)),n.addEventListener("click",function(o){o.target===n&&a(o)}),document.addEventListener("keydown",function(o){o.key==="Escape"&&n.classList.contains("active")&&a()}),n.addEventListener("click",r);let Y=0;n.addEventListener("touchstart",function(o){Y=o.touches[0].clientY},{passive:!0}),n.addEventListener("touchend",function(o){o.changedTouches[0].clientY-Y>50&&o.target===n&&a()});let w;window.addEventListener("scroll",function(){w&&clearTimeout(w),w=setTimeout(function(){window.scrollY>0?s.classList.add("scrolled"):s.classList.remove("scrolled")},10)}),window.addEventListener("load",function(){const o=window.location.hash;if(o){const p=o.substring(1),m=document.getElementById(p);m&&setTimeout(()=>{m.scrollIntoView({behavior:"smooth",block:"start"})},100)}})}function P(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const n=e.getAttribute("href");if(n==="#"){window.scrollTo({top:0,behavior:"smooth"});return}const c=document.querySelector(n);c&&c.scrollIntoView({behavior:"smooth",block:"start"})})})}function B(){if(window.location.hash){const e=document.querySelector(window.location.hash);e&&setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"start"})},500)}}document.addEventListener("dragstart",function(e){e.target.tagName==="IMG"&&e.preventDefault()});document.addEventListener("DOMContentLoaded",function(){D(),P(),B()});let F=0,I=0,y=0,v=0,x=window.innerWidth/2,q=window.innerHeight/2;const C=[{selector:".one-obj",speed:.05,spreadFactor:1.2,element:null,currentX:0,currentY:0},{selector:".two-obj",speed:.04,spreadFactor:1.4,element:null,currentX:0,currentY:0},{selector:".three-obj",speed:.03,spreadFactor:1.6,element:null,currentX:0,currentY:0},{selector:".four-obj",speed:.07,spreadFactor:1.3,element:null,currentX:0,currentY:0},{selector:".five-obj",speed:.03,spreadFactor:1.5,element:null,currentX:0,currentY:0},{selector:".six-obj",speed:.07,spreadFactor:1.2,element:null,currentX:0,currentY:0},{selector:".seven-obj",speed:.06,spreadFactor:1.4,element:null,currentX:0,currentY:0},{selector:".eight-obj",speed:.01,spreadFactor:1.7,element:null,currentX:0,currentY:0},{selector:".nine-obj",speed:.05,spreadFactor:1.3,element:null,currentX:0,currentY:0},{selector:".ten-obj",speed:.06,spreadFactor:1.5,element:null,currentX:0,currentY:0},{selector:".pc",speed:.03,spreadFactor:1,element:null,currentX:0,currentY:0},{selector:".a01",speed:.05,spreadFactor:1.3,element:null,currentX:0,currentY:0},{selector:".a02",speed:.04,spreadFactor:1.5,element:null,currentX:0,currentY:0},{selector:".a03",speed:.06,spreadFactor:1.4,element:null,currentX:0,currentY:0},{selector:".a04",speed:.03,spreadFactor:1.6,element:null,currentX:0,currentY:0},{selector:".a05",speed:.07,spreadFactor:1.2,element:null,currentX:0,currentY:0},{selector:".phone",speed:.03,spreadFactor:1,element:null,currentX:0,currentY:0}];function k(){C.forEach(e=>{e.element=document.querySelector(e.selector),e.element&&(e.element.style.willChange="transform",e.element.style.transform="translate3d(0, 0, 0)")})}function T(){y+=(F-y)*.1,v+=(I-v)*.1;const e=y-x,t=v-q,n=Math.sqrt(e*e+t*t),c=e/n,s=t/n;C.forEach(r=>{if(!r.element)return;let i,a;r.selector===".pc"||r.selector===".phone"?(i=e*r.speed,a=t*r.speed):(i=-e*r.speed*r.spreadFactor,a=-t*r.speed*r.spreadFactor,i+=s*n*r.speed*(r.spreadFactor-1),a-=c*n*r.speed*(r.spreadFactor-1)),r.currentX+=(i-r.currentX)*.1,r.currentY+=(a-r.currentY)*.1,r.element.style.transform=`translate3d(${r.currentX}px, ${r.currentY}px, 0)`}),requestAnimationFrame(T)}function M(e){F=e.clientX,I=e.clientY}function O(){x=window.innerWidth/2,q=window.innerHeight/2}window.addEventListener("mousemove",M,{passive:!0});window.addEventListener("resize",O);k();T();const g=document.querySelector(".about-cat"),u=document.querySelector(".about-hand");let f=100,l=50,h=!1;const z=25;g.style.transform=`translateY(${f}px)`;g.style.transition="transform 0.5s";u.style.transform=`translateY(${l}px) rotate(0deg)`;u.style.transition="transform 0.5s";u.style.transformOrigin="center bottom";window.addEventListener("mousemove",e=>{const t=g.getBoundingClientRect(),n=e.clientX>t.left-150&&e.clientX<t.right+150&&e.clientY>t.top-150&&e.clientY<t.top;if(n&&!h){const c=setInterval(()=>{f>0?(f-=2,l>z&&(l-=1),g.style.transform=`translateY(${f}px)`,u.style.transform=`translateY(${l}px) rotate(0deg)`):(clearInterval(c),h=!0,setTimeout(()=>{u.style.transform=`translateY(${l}px) rotate(-20deg)`,setTimeout(()=>{u.style.transform=`translateY(${l}px) rotate(10deg)`},500)},100))},16)}!n&&h&&(f=100,l=50,h=!1,g.style.transform=`translateY(${f}px)`,u.style.transform=`translateY(${l}px) rotate(0deg)`)});$(".air-content").mousemove(function(e){$("#cross").css({left:e.pageX+"px",top:e.pageY+"px"})});
